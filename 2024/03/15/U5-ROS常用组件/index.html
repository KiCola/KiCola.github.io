<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>U5_ROS常用组件 | In Zero's World</title><meta name="author" content="Zero"><meta name="copyright" content="Zero"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="U5_ROS常用组件在ROS中内置一些比较实用的工具，通过这些工具可以方便快捷的实现某个功能或调试程序，从而提高开发效率，本章主要介绍ROS中内置的如下组件:  TF坐标变换，实现不同类型的坐标系之间的转换； rosbag 用于录制ROS节点的执行过程并可以重放该过程； rqt 工具箱，集成了多款图形化的调试工具。  本章预期达成的学习目标:  了解 TF 坐标变换的概念以及应用场景； 能够独立完">
<meta property="og:type" content="article">
<meta property="og:title" content="U5_ROS常用组件">
<meta property="og:url" content="http://inzeroworld.com.cn/2024/03/15/U5-ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/index.html">
<meta property="og:site_name" content="In Zero&#39;s World">
<meta property="og:description" content="U5_ROS常用组件在ROS中内置一些比较实用的工具，通过这些工具可以方便快捷的实现某个功能或调试程序，从而提高开发效率，本章主要介绍ROS中内置的如下组件:  TF坐标变换，实现不同类型的坐标系之间的转换； rosbag 用于录制ROS节点的执行过程并可以重放该过程； rqt 工具箱，集成了多款图形化的调试工具。  本章预期达成的学习目标:  了解 TF 坐标变换的概念以及应用场景； 能够独立完">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png">
<meta property="article:published_time" content="2024-03-14T17:29:12.000Z">
<meta property="article:modified_time" content="2024-03-14T17:34:41.489Z">
<meta property="article:author" content="Zero">
<meta property="article:tag" content="ROS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://inzeroworld.com.cn/2024/03/15/U5-ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Zero","link":"链接: ","source":"来源: In Zero's World","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'U5_ROS常用组件',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-15 01:34:41'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2024/03/06/DdFmuoWIlGbg6fU.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photo/"><i class="fa-fw fa fa-file-photo-o"></i><span> Photo</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/animations/"><i class="fa-fw fas fa-film"></i><span> Animation</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Game</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png')"><nav id="nav"><span id="blog-info"><a href="/" title="In Zero's World"><img class="site-icon" src="https://cdn.pixabay.com/photo/2017/03/08/14/20/flat-2126879_960_720.png"/><span class="site-name">In Zero's World</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photo/"><i class="fa-fw fa fa-file-photo-o"></i><span> Photo</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/animations/"><i class="fa-fw fas fa-film"></i><span> Animation</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Game</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">U5_ROS常用组件</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-14T17:29:12.000Z" title="发表于 2024-03-15 01:29:12">2024-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-14T17:34:41.489Z" title="更新于 2024-03-15 01:34:41">2024-03-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ROS/">ROS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="U5_ROS常用组件"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="U5-ROS常用组件"><a href="#U5-ROS常用组件" class="headerlink" title="U5_ROS常用组件"></a>U5_ROS常用组件</h1><p>在ROS中内置一些比较实用的工具，通过这些工具可以方便快捷的实现某个功能或调试程序，从而提高开发效率，本章主要介绍ROS中内置的如下组件:</p>
<ul>
<li>TF坐标变换，实现不同类型的坐标系之间的转换；</li>
<li>rosbag 用于录制ROS节点的执行过程并可以重放该过程；</li>
<li>rqt 工具箱，集成了多款图形化的调试工具。</li>
</ul>
<p>本章预期达成的学习目标:</p>
<ul>
<li>了解 TF 坐标变换的概念以及应用场景；</li>
<li>能够独立完成TF案例:小乌龟跟随；</li>
<li>可以使用 rosbag 命令或编码的形式实现录制与回放；</li>
<li>能够熟练使用rqt中的图形化工具。</li>
</ul>
<h2 id="5-1-TF坐标变换"><a href="#5-1-TF坐标变换" class="headerlink" title="5.1 TF坐标变换"></a>5.1 TF坐标变换</h2><p>机器人系统上，有多个传感器，如激光雷达、摄像头等，有的传感器是可以感知机器人周边的物体方位(或者称之为:坐标，横向、纵向、高度的距离信息)的，以协助机器人定位障碍物，可以直接将物体相对该传感器的方位信息，等价于物体相对于机器人系统或机器人其它组件的方位信息吗？显示是不行的，这中间需要一个转换过程。更具体描述如下:</p>
<blockquote>
<p>场景1:雷达与小车</p>
<p>现有一移动式机器人底盘，在底盘上安装了一雷达，雷达相对于底盘的偏移量已知，现雷达检测到一障碍物信息，获取到坐标分别为(x,y,z)，该坐标是以雷达为参考系的，如何将这个坐标转换成以小车为参考系的坐标呢？</p>
</blockquote>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/10TF01-17092115612875.png" alt="img"></p>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/11TF02-17092115612877.png" alt="img"></p>
<blockquote>
<p>场景2:现有一带机械臂的机器人(比如:PR2)需要夹取目标物，当前机器人头部摄像头可以探测到目标物的坐标(x,y,z)，不过该坐标是以摄像头为参考系的，而实际操作目标物的是机械臂的夹具，当前我们需要将该坐标转换成相对于机械臂夹具的坐标，这个过程如何实现？</p>
</blockquote>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/PR2坐标变换-17092115612879.png" alt="img"></p>
<p>当然，根据我们高中学习的知识，在明确了不同坐标系之间的的相对关系，就可以实现任何坐标点在不同坐标系之间的转换，但是该计算实现是较为常用的，且算法也有点复杂，因此在 ROS 中直接封装了相关的模块: 坐标变换(TF)。</p>
<hr>
<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a><strong>概念</strong></h4><p>**tf:**TransForm Frame,坐标变换</p>
<p>**坐标系:**ROS 中是通过坐标系统开标定物体的，确切的将是通过右手坐标系来标定的。</p>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/右手坐标系-170921156128711.jpg" alt="img"></p>
<h4 id="作用"><a href="#作用" class="headerlink" title="作用"></a><strong>作用</strong></h4><p>在 ROS 中用于实现不同坐标系之间的点或向量的转换。</p>
<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a><strong>案例</strong></h4><p><strong>小乌龟跟随案例：</strong>如本章引言部分演示。</p>
<h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><p>在ROS中坐标变换最初对应的是tf，不过在 hydro 版本开始, tf 被弃用，迁移到 tf2,后者更为简洁高效，tf2对应的常用功能包有:</p>
<p>tf2_geometry_msgs:可以将ROS消息转换成tf2消息。</p>
<p>tf2: 封装了坐标变换的常用消息。</p>
<p>tf2_ros:为tf2提供了roscpp和rospy绑定，封装了坐标变换常用的API。</p>
<h3 id="5-1-1-坐标msg消息"><a href="#5-1-1-坐标msg消息" class="headerlink" title="5.1.1 坐标msg消息"></a>5.1.1 坐标msg消息</h3><p>订阅发布模型中数据载体 msg 是一个重要实现，首先需要了解一下，在坐标转换实现中常用的 msg:<code>geometry_msgs/TransformStamped</code>和<code>geometry_msgs/PointStamped</code></p>
<p>前者用于传输坐标系相关位置信息，后者用于传输某个坐标系内坐标点的信息。在坐标变换中，频繁的需要使用到坐标系的相对关系以及坐标点信息。</p>
<h4 id="1-geometry-msgs-TransformStamped"><a href="#1-geometry-msgs-TransformStamped" class="headerlink" title="1.geometry_msgs&#x2F;TransformStamped"></a>1.geometry_msgs&#x2F;TransformStamped</h4><p>命令行键入:<code>rosmsg info geometry_msgs/TransformStamped</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">std_msgs/Header header                     #头信息</span><br><span class="line">  uint32 seq                                #|-- 序列号</span><br><span class="line">  time stamp                                #|-- 时间戳</span><br><span class="line">  string frame_id                            #|-- 坐标 ID</span><br><span class="line">string child_frame_id                    #子坐标系的 id</span><br><span class="line">geometry_msgs/Transform transform        #坐标信息</span><br><span class="line">  geometry_msgs/Vector3 translation        #偏移量</span><br><span class="line">    float64 x                                #|-- X 方向的偏移量</span><br><span class="line">    float64 y                                #|-- Y 方向的偏移量</span><br><span class="line">    float64 z                                #|-- Z 方向上的偏移量</span><br><span class="line">  geometry_msgs/Quaternion rotation        #四元数</span><br><span class="line">    float64 x                                </span><br><span class="line">    float64 y                                </span><br><span class="line">    float64 z                                </span><br><span class="line">    float64 w</span><br></pre></td></tr></table></figure>

<p>四元数用于表示坐标的相对姿态</p>
<h4 id="2-geometry-msgs-PointStamped"><a href="#2-geometry-msgs-PointStamped" class="headerlink" title="2.geometry_msgs&#x2F;PointStamped"></a>2.geometry_msgs&#x2F;PointStamped</h4><p>命令行键入:<code>rosmsg info geometry_msgs/PointStamped</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">std_msgs/Header header                    #头</span><br><span class="line">  uint32 seq                                #|-- 序号</span><br><span class="line">  time stamp                                #|-- 时间戳</span><br><span class="line">  string frame_id                            #|-- 所属坐标系的 id</span><br><span class="line">geometry_msgs/Point point                #点坐标</span><br><span class="line">  float64 x                                    #|-- x y z 坐标</span><br><span class="line">  float64 y</span><br><span class="line">  float64 z</span><br></pre></td></tr></table></figure>

<h3 id="5-1-2-静态坐标变换"><a href="#5-1-2-静态坐标变换" class="headerlink" title="5.1.2 静态坐标变换"></a>5.1.2 静态坐标变换</h3><p>所谓静态坐标变换，是指两个坐标系之间的相对位置是固定的。</p>
<p><strong>需求描述:</strong></p>
<p>现有一机器人模型，核心构成包含主体与雷达，各对应一坐标系，坐标系的原点分别位于主体与雷达的物理中心，已知雷达原点相对于主体原点位移关系如下: x 0.2 y0.0 z0.5。当前雷达检测到一障碍物，在雷达坐标系中障碍物的坐标为 (2.0 3.0  5.0),请问，该障碍物相对于主体的坐标是多少？</p>
<p><strong>结果演示:</strong><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/静态坐标变换.PNG" alt="img"><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/静态坐标变换_坐标系关系.PNG" alt="img"></p>
<p><strong>实现分析:</strong></p>
<ol>
<li>坐标系相对关系，可以通过发布方发布</li>
<li>订阅方，订阅到发布的坐标系相对关系，再传入坐标点信息(可以写死)，然后借助于 tf 实现坐标变换，并将结果输出</li>
</ol>
<p>**实现流程:**C++ 与 Python 实现流程一致</p>
<ol>
<li>新建功能包，添加依赖</li>
<li>编写发布方实现</li>
<li>编写订阅方实现</li>
<li>执行并查看结果</li>
</ol>
<hr>
<p>方案A:C++实现</p>
<h4 id="1-创建功能包"><a href="#1-创建功能包" class="headerlink" title="1.创建功能包"></a>1.创建功能包</h4><p>创建项目功能包依赖于 tf2、tf2_ros、tf2_geometry_msgs、roscpp rospy std_msgs geometry_msgs</p>
<h4 id="2-发布方"><a href="#2-发布方" class="headerlink" title="2.发布方"></a>2.发布方</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    静态坐标变换发布方:</span></span><br><span class="line"><span class="comment">        发布关于 laser 坐标系的位置信息 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    实现流程:</span></span><br><span class="line"><span class="comment">        1.包含头文件</span></span><br><span class="line"><span class="comment">        2.初始化 ROS 节点</span></span><br><span class="line"><span class="comment">        3.创建静态坐标转换广播器</span></span><br><span class="line"><span class="comment">        4.创建坐标系信息</span></span><br><span class="line"><span class="comment">        5.广播器发布坐标系信息</span></span><br><span class="line"><span class="comment">        6.spin()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/static_transform_broadcaster.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/TransformStamped.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2/LinearMath/Quaternion.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;static_broadcastor&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建静态坐标转换广播器</span></span><br><span class="line">    tf2_ros::StaticTransformBroadcaster broadcaster;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建坐标系信息</span></span><br><span class="line">    geometry_msgs::TransformStamped ts;</span><br><span class="line">    <span class="comment">//头信息</span></span><br><span class="line">    ts.header.seq = <span class="number">100</span>;</span><br><span class="line">    ts.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">    ts.header.frame_id = <span class="string">&quot;base_link&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置子级坐标系</span></span><br><span class="line">    ts.child_frame_id = <span class="string">&quot;laser&quot;</span>;</span><br><span class="line"></span><br><span class="line">    ts.transform.translation.x = <span class="number">0.2</span>;</span><br><span class="line">    ts.transform.translation.y = <span class="number">0.0</span>;</span><br><span class="line">    ts.transform.translation.z = <span class="number">0.4</span>;</span><br><span class="line">    <span class="comment">//设置四元数，将欧拉角数据转换成四元数</span></span><br><span class="line">    tf2::Quaternion qtn;</span><br><span class="line">    qtn.<span class="built_in">setRPY</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    ts.transform.rotation.x = qtn.<span class="built_in">getX</span>();</span><br><span class="line">    ts.transform.rotation.y = qtn.<span class="built_in">getY</span>();</span><br><span class="line">    ts.transform.rotation.z = qtn.<span class="built_in">getZ</span>();</span><br><span class="line">    ts.transform.rotation.w = qtn.<span class="built_in">getW</span>();</span><br><span class="line">    broadcaster.<span class="built_in">sendTransform</span>(ts);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件此处略。</p>
<h4 id="3-订阅方"><a href="#3-订阅方" class="headerlink" title="3.订阅方"></a>3.订阅方</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    订阅坐标系信息，生成一个相对于 子级坐标系的坐标点数据，转换成父级坐标系中的坐标点</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    实现流程:</span></span><br><span class="line"><span class="comment">        1.包含头文件</span></span><br><span class="line"><span class="comment">        2.初始化 ROS 节点</span></span><br><span class="line"><span class="comment">        3.创建 TF 订阅节点</span></span><br><span class="line"><span class="comment">        4.生成一个坐标点(相对于子级坐标系)</span></span><br><span class="line"><span class="comment">        5.转换坐标点(相对于父级坐标系)</span></span><br><span class="line"><span class="comment">        6.spin()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/transform_listener.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/buffer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/PointStamped.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_geometry_msgs/tf2_geometry_msgs.h&quot;</span> <span class="comment">//调用transform必须包含该头文件</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;tf_sub&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//创建TF订阅节点</span></span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">listener</span><span class="params">(buffer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span>(ros::<span class="built_in">ok</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//生成座标点（相对于子级坐标系）</span></span><br><span class="line">        geometry_msgs::PointStamped point_laser;</span><br><span class="line">        point_laser.header.frame_id = <span class="string">&quot;laser&quot;</span> ;</span><br><span class="line">        point_laser.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">        point_laser.point.x = <span class="number">1</span>;</span><br><span class="line">        point_laser.point.y = <span class="number">2</span>;</span><br><span class="line">        point_laser.point.z = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//转换坐标系（相对于父坐标系）</span></span><br><span class="line">        <span class="keyword">try</span> <span class="comment">//使用 try 语句或休眠，否则可能由于缓存接收延迟而导致坐标转换失败</span></span><br><span class="line">        &#123;</span><br><span class="line">            geometry_msgs::PointStamped point_base;</span><br><span class="line">            point_base = buffer.<span class="built_in">transform</span>(point_laser,<span class="string">&quot;base_link&quot;</span>);<span class="comment">//baser_link</span></span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;转换后：(%.2f, %.2f, %.2f), 参考：%s&quot;</span>,point_base.point.x,point_base.point.y,point_base.point.z,point_base.header.frame_id.<span class="built_in">c_str</span>());<span class="comment">//point_base.header.frame_id.c_str()</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;程序异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="4-配置"><a href="#4-配置" class="headerlink" title="4. 配置"></a>4. 配置</h4><p>tf_try.launch</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span> = <span class="string">&quot;tf_try&quot;</span> <span class="attr">type</span> = <span class="string">&quot;static_broadcastor&quot;</span> <span class="attr">name</span> = <span class="string">&quot;static_broadcastor&quot;</span> <span class="attr">output</span> = <span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span> = <span class="string">&quot;tf_try&quot;</span> <span class="attr">type</span> = <span class="string">&quot;tf_sub&quot;</span> <span class="attr">name</span> = <span class="string">&quot;tf_sub&quot;</span> <span class="attr">output</span> = <span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="5-执行"><a href="#5-执行" class="headerlink" title="5.执行"></a>5.执行</h4><p>可以使用命令行或launch文件的方式分别启动发布节点与订阅节点，如果程序无异常，控制台将输出，坐标转换后的结果。</p>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/5efd4f0a5fac09a101a0d0ef354862c2.png" alt="5efd4f0a5fac09a101a0d0ef354862c2"><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/f23c94bcd7823b117e6edc171eec5166.png" alt="f23c94bcd7823b117e6edc171eec5166"></p>
<h3 id="5-1-3-动态坐标变换"><a href="#5-1-3-动态坐标变换" class="headerlink" title="5.1.3 动态坐标变换"></a>5.1.3 动态坐标变换</h3><p>所谓动态坐标变换，是指两个坐标系之间的相对位置是变化的。</p>
<p><strong>需求描述:</strong></p>
<p>启动 turtlesim_node,该节点中窗体有一个世界坐标系(左下角为坐标系原点)，乌龟是另一个坐标系，键盘控制乌龟运动，将两个坐标系的相对位置动态发布。</p>
<p><strong>结果演示:</strong></p>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/坐标变换_动态.gif" alt="img"></p>
<p><strong>实现分析:</strong></p>
<ol>
<li>乌龟本身不但可以看作坐标系，也是世界坐标系中的一个坐标点</li>
<li>订阅 turtle1&#x2F;pose,可以获取乌龟在世界坐标系的 x坐标、y坐标、偏移量以及线速度和角速度</li>
<li>将 pose 信息转换成 坐标系相对信息并发布</li>
</ol>
<p>**实现流程:**C++ 与 Python 实现流程一致</p>
<ol>
<li>新建功能包，添加依赖</li>
<li>创建坐标相对关系发布方(同时需要订阅乌龟位姿信息)</li>
<li>创建坐标相对关系订阅方</li>
<li>执行</li>
</ol>
<hr>
<p>方案A:C++实现</p>
<h4 id="1-创建功能包-1"><a href="#1-创建功能包-1" class="headerlink" title="1.创建功能包"></a>1.创建功能包</h4><p>创建项目功能包依赖于 tf2、tf2_ros、tf2_geometry_msgs、roscpp rospy std_msgs geometry_msgs、turtlesim</p>
<h4 id="2-发布方-1"><a href="#2-发布方-1" class="headerlink" title="2.发布方"></a>2.发布方</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    动态的坐标系相对姿态发布(一个坐标系相对于另一个坐标系的相对姿态是不断变动的)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    需求: 启动 turtlesim_node,该节点中窗体有一个世界坐标系(左下角为坐标系原点)，乌龟是另一个坐标系，键盘</span></span><br><span class="line"><span class="comment">    控制乌龟运动，将两个坐标系的相对位置动态发布</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    实现分析:</span></span><br><span class="line"><span class="comment">        1.乌龟本身不但可以看作坐标系，也是世界坐标系中的一个坐标点</span></span><br><span class="line"><span class="comment">        2.订阅 turtle1/pose,可以获取乌龟在世界坐标系的 x坐标、y坐标、偏移量以及线速度和角速度</span></span><br><span class="line"><span class="comment">        3.将 pose 信息转换成 坐标系相对信息并发布</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    实现流程:</span></span><br><span class="line"><span class="comment">        1.包含头文件</span></span><br><span class="line"><span class="comment">        2.初始化 ROS 节点</span></span><br><span class="line"><span class="comment">        3.创建 ROS 句柄</span></span><br><span class="line"><span class="comment">        4.创建订阅对象</span></span><br><span class="line"><span class="comment">        5.回调函数处理订阅到的数据(实现TF广播)</span></span><br><span class="line"><span class="comment">            5-1.创建 TF 广播器</span></span><br><span class="line"><span class="comment">            5-2.创建 广播的数据(通过 pose 设置)</span></span><br><span class="line"><span class="comment">            5-3.广播器发布数据</span></span><br><span class="line"><span class="comment">        6.spin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;turtlesim/Pose.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/TransformStamped.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/transform_broadcaster.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2/LinearMath/Quaternion.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">broadPose</span><span class="params">(<span class="type">const</span> turtlesim::Pose::ConstPtr &amp; pose)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//创建TF广播器</span></span><br><span class="line">    <span class="type">static</span> tf2_ros::TransformBroadcaster broadcaster;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建 广播数据</span></span><br><span class="line">    geometry_msgs::TransformStamped tfs;</span><br><span class="line">    tfs.header.frame_id = <span class="string">&quot;world&quot;</span>;</span><br><span class="line">    tfs.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line"></span><br><span class="line">    tfs.child_frame_id = <span class="string">&quot;turtle1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    tfs.transform.translation.x = pose-&gt;x;</span><br><span class="line">    tfs.transform.translation.y = pose-&gt;y;</span><br><span class="line">    tfs.transform.translation.z = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    tf2::Quaternion qtn;</span><br><span class="line">    qtn.<span class="built_in">setRPY</span>(<span class="number">0</span>,<span class="number">0</span>,pose-&gt;theta);</span><br><span class="line">    tfs.transform.rotation.x = qtn.<span class="built_in">getX</span>();</span><br><span class="line">    tfs.transform.rotation.y = qtn.<span class="built_in">getY</span>();</span><br><span class="line">    tfs.transform.rotation.z = qtn.<span class="built_in">getZ</span>();</span><br><span class="line">    tfs.transform.rotation.w = qtn.<span class="built_in">getW</span>();</span><br><span class="line"></span><br><span class="line">    broadcaster.<span class="built_in">sendTransform</span>(tfs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;tf_pub&quot;</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    ros::Subscriber sub = nh.<span class="built_in">subscribe</span>&lt;turtlesim::Pose&gt;(<span class="string">&quot;/turtle1/pose&quot;</span>,<span class="number">1000</span>, broadPose);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-订阅方-1"><a href="#3-订阅方-1" class="headerlink" title="3.订阅方"></a>3.订阅方</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/transform_listener.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/PointStamped.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/buffer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_geometry_msgs/tf2_geometry_msgs.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;tf_sub&quot;</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">listener</span><span class="params">(buffer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(ros::<span class="built_in">ok</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        geometry_msgs::PointStamped point_laser;</span><br><span class="line">        point_laser.header.frame_id = <span class="string">&quot;turtle1&quot;</span>;</span><br><span class="line">        point_laser.header.stamp = ros::<span class="built_in">Time</span>();</span><br><span class="line">        point_laser.point.x = <span class="number">1</span>;</span><br><span class="line">        point_laser.point.y = <span class="number">2</span>;</span><br><span class="line">        point_laser.point.z = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//转换坐标系</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            geometry_msgs::PointStamped point_base;</span><br><span class="line">            point_base = buffer.<span class="built_in">transform</span>(point_laser,<span class="string">&quot;world&quot;</span>);</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;坐标点：(%.2f, %.2f, %.2f)&quot;</span>,point_base.point.x, point_base.point.y, point_base.point.z);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;程序异常：%s&quot;</span>,e.<span class="built_in">what</span>());</span><br><span class="line">            <span class="comment">//std::cerr &lt;&lt; e.what() &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-配置-1"><a href="#4-配置-1" class="headerlink" title="4.配置"></a>4.配置</h4><p>dynamic_tf.launch</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span> = <span class="string">&quot;turtlesim&quot;</span> <span class="attr">type</span> = <span class="string">&quot;turtlesim_node&quot;</span> <span class="attr">name</span> = <span class="string">&quot;turtlesim_node&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span> = <span class="string">&quot;turtlesim&quot;</span> <span class="attr">type</span> = <span class="string">&quot;turtle_teleop_key&quot;</span> <span class="attr">name</span> = <span class="string">&quot;turtle_teleop_key&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span> = <span class="string">&quot;dynamic_tf&quot;</span> <span class="attr">type</span> = <span class="string">&quot;dynamic_tf_pub&quot;</span> <span class="attr">name</span> = <span class="string">&quot;dynamic_tf_pub&quot;</span> <span class="attr">output</span> = <span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span> = <span class="string">&quot;dynamic_tf&quot;</span> <span class="attr">type</span> = <span class="string">&quot;dynamic_tf_sub&quot;</span> <span class="attr">name</span> = <span class="string">&quot;dynamic_tf_sub&quot;</span> <span class="attr">output</span> = <span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-执行-1"><a href="#5-执行-1" class="headerlink" title="5 执行"></a>5 执行</h4><p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/efcb55867487e0b1003f1386deba7238.png" alt="efcb55867487e0b1003f1386deba7238"></p>
<h3 id="5-1-4-多坐标变换"><a href="#5-1-4-多坐标变换" class="headerlink" title="5.1.4 多坐标变换"></a>5.1.4 多坐标变换</h3><p><strong>需求描述:</strong></p>
<p>现有坐标系统，父级坐标系统 world,下有两子级系统 son1，son2，son1 相对于 world，以及 son2 相对于  world 的关系是已知的，求 son1原点在 son2中的坐标，又已知在 son1中一点的坐标，要求求出该点在 son2 中的坐标</p>
<p><strong>实现分析:</strong></p>
<ol>
<li>首先，需要发布 son1 相对于 world，以及 son2 相对于 world 的坐标消息</li>
<li>然后，需要订阅坐标发布消息，并取出订阅的消息，借助于 tf2 实现 son1 和 son2 的转换</li>
<li>最后，还要实现坐标点的转换</li>
</ol>
<p>**实现流程:**C++ 与 Python 实现流程一致</p>
<ol>
<li>新建功能包，添加依赖</li>
<li>创建坐标相对关系发布方(需要发布两个坐标相对关系)</li>
<li>创建坐标相对关系订阅方</li>
<li>执行</li>
</ol>
<hr>
<p>方案A:C++实现</p>
<h4 id="1-创建功能包-2"><a href="#1-创建功能包-2" class="headerlink" title="1.创建功能包"></a>1.创建功能包</h4><p>创建项目功能包依赖于 tf2、tf2_ros、tf2_geometry_msgs、roscpp rospy std_msgs geometry_msgs、turtlesim</p>
<h4 id="2-发布方-2"><a href="#2-发布方-2" class="headerlink" title="2.发布方"></a>2.发布方</h4><p>为了方便，使用静态坐标变换发布</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;tf2_ros&quot;</span> <span class="attr">type</span>=<span class="string">&quot;static_transform_publisher&quot;</span> <span class="attr">name</span>=<span class="string">&quot;son1&quot;</span> <span class="attr">args</span>=<span class="string">&quot;0.2 0.8 0.3 0 0 0 /world /son1&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;tf2_ros&quot;</span> <span class="attr">type</span>=<span class="string">&quot;static_transform_publisher&quot;</span> <span class="attr">name</span>=<span class="string">&quot;son2&quot;</span> <span class="attr">args</span>=<span class="string">&quot;0.5 0 0 0 0 0 /world /son2&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-订阅方-2"><a href="#3-订阅方-2" class="headerlink" title="3.订阅方"></a>3.订阅方</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">需求:</span></span><br><span class="line"><span class="comment">    现有坐标系统，父级坐标系统 world,下有两子级系统 son1，son2，</span></span><br><span class="line"><span class="comment">    son1 相对于 world，以及 son2 相对于 world 的关系是已知的，</span></span><br><span class="line"><span class="comment">    求 son1 与 son2中的坐标关系，又已知在 son1中一点的坐标，要求求出该点在 son2 中的坐标</span></span><br><span class="line"><span class="comment">实现流程:</span></span><br><span class="line"><span class="comment">    1.包含头文件</span></span><br><span class="line"><span class="comment">    2.初始化 ros 节点</span></span><br><span class="line"><span class="comment">    3.创建 ros 句柄</span></span><br><span class="line"><span class="comment">    4.创建 TF 订阅对象</span></span><br><span class="line"><span class="comment">    5.解析订阅信息中获取 son1 坐标系原点在 son2 中的坐标</span></span><br><span class="line"><span class="comment">      解析 son1 中的点相对于 son2 的坐标</span></span><br><span class="line"><span class="comment">    6.spin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_geometry_msgs/tf2_geometry_msgs.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/transform_listener.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2/LinearMath/Quaternion.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/TransformStamped.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/PointStamped.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;multi_sub&quot;</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">listener</span><span class="params">(buffer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span>(ros::<span class="built_in">ok</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            geometry_msgs::TransformStamped tfs = buffer.<span class="built_in">lookupTransform</span>(<span class="string">&quot;son1&quot;</span>,<span class="string">&quot;son2&quot;</span>,ros::<span class="built_in">Time</span>(<span class="number">0</span>));</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;Son1 相对于 Son2 的坐标关系:父坐标系ID=%s&quot;</span>,tfs.header.frame_id.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;Son1 相对于 Son2 的坐标关系:子坐标系ID=%s&quot;</span>,tfs.child_frame_id.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;Son1 相对于 Son2 的坐标关系:x=%.2f,y=%.2f,z=%.2f&quot;</span>,</span><br><span class="line">                    tfs.transform.translation.x,</span><br><span class="line">                    tfs.transform.translation.y,</span><br><span class="line">                    tfs.transform.translation.z</span><br><span class="line">                    );</span><br><span class="line">            </span><br><span class="line">            geometry_msgs::PointStamped ps;</span><br><span class="line">            ps.header.frame_id = <span class="string">&quot;son1&quot;</span>;</span><br><span class="line">            ps.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">            ps.point.x = <span class="number">1.0</span>;</span><br><span class="line">            ps.point.y = <span class="number">2.0</span>;</span><br><span class="line">            ps.point.z = <span class="number">3.0</span>;</span><br><span class="line">    </span><br><span class="line">            geometry_msgs::PointStamped psAtSon2;</span><br><span class="line">            psAtSon2 = buffer.<span class="built_in">transform</span>(ps,<span class="string">&quot;son2&quot;</span>);</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;在 Son2 中的坐标:x=%.2f,y=%.2f,z=%.2f&quot;</span>,</span><br><span class="line">                    psAtSon2.point.x,</span><br><span class="line">                    psAtSon2.point.y,</span><br><span class="line">                    psAtSon2.point.z</span><br><span class="line">                    );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;异常信息：%s&quot;</span>,e.<span class="built_in">what</span>());</span><br><span class="line">            <span class="comment">//std::cerr &lt;&lt; e.what() &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件此处略。</p>
<h4 id="4-执行"><a href="#4-执行" class="headerlink" title="4.执行"></a>4.执行</h4><p>可以使用命令行或launch文件的方式分别启动发布节点与订阅节点，如果程序无异常，将输出换算后的结果。</p>
<p>![2024-03-03 12-46-03 的屏幕截图](C:&#x2F;Users&#x2F;zzr&#x2F;Downloads&#x2F;U5_ROS常用组件.assets&#x2F;2024-03-03 12-46-03 的屏幕截图.png)</p>
<h3 id="5-1-5-坐标系关系查看"><a href="#5-1-5-坐标系关系查看" class="headerlink" title="5.1.5 坐标系关系查看"></a>5.1.5 坐标系关系查看</h3><p>在机器人系统中，涉及的坐标系有多个，为了方便查看，ros 提供了专门的工具，可以用于生成显示坐标系关系的 pdf 文件，该文件包含树形结构的坐标系图谱。</p>
<h4 id="5-1准备"><a href="#5-1准备" class="headerlink" title="5.1准备"></a>5.1准备</h4><p>首先调用<code>rospack find tf2_tools</code>查看是否包含该功能包，如果没有，请使用如下命令安装:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ros-noetic-tf2-tools</span><br></pre></td></tr></table></figure>

<h4 id="2使用5"><a href="#2使用5" class="headerlink" title=".2使用5"></a>.2使用5</h4><h5 id="5-2-1生成-pdf-文件"><a href="#5-2-1生成-pdf-文件" class="headerlink" title="5.2.1生成 pdf 文件"></a>5.2.1生成 pdf 文件</h5><p>启动坐标系广播程序之后，运行如下命令:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun tf2_tools view_frames.py</span><br></pre></td></tr></table></figure>

<p>会产生类似于下面的日志信息:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[INFO] [1592920556.827549]: Listening to tf data during 5 seconds...</span><br><span class="line">[INFO] [1592920561.841536]: Generating graph in frames.pdf file...</span><br></pre></td></tr></table></figure>

<p>查看当前目录会生成一个 frames.pdf 文件</p>
<h5 id="5-2-2查看文件"><a href="#5-2-2查看文件" class="headerlink" title="5.2.2查看文件"></a>5.2.2查看文件</h5><p>可以直接进入目录打开文件，或者调用命令查看文件:<code>evince frames.pdf</code></p>
<p>内如如图所示:<img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/12坐标变换.PNG" alt="img"></p>
<h3 id="5-1-6-TF坐标变换实操"><a href="#5-1-6-TF坐标变换实操" class="headerlink" title="5.1.6 TF坐标变换实操"></a>5.1.6 TF坐标变换实操</h3><p><strong>需求描述:</strong></p>
<p>程序启动之初: 产生两只乌龟，中间的乌龟(A) 和 左下乌龟(B), B 会自动运行至A的位置，并且键盘控制时，只是控制 A 的运动，但是 B 可以跟随 A 运行</p>
<p><strong>结果演示:</strong></p>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/TF坐标变换.gif" alt="img"></p>
<p><strong>实现分析:</strong></p>
<p>乌龟跟随实现的核心，是乌龟A和B都要发布相对世界坐标系的坐标信息，然后，订阅到该信息需要转换获取A相对于B坐标系的信息，最后，再生成速度信息，并控制B运动。</p>
<ol>
<li>启动乌龟显示节点</li>
<li>在乌龟显示窗体中生成一只新的乌龟(需要使用服务)</li>
<li>编写两只乌龟发布坐标信息的节点</li>
<li>编写订阅节点订阅坐标信息并生成新的相对关系生成速度信息</li>
</ol>
<p>**实现流程:**C++ 与 Python 实现流程一致</p>
<ol>
<li>新建功能包，添加依赖</li>
<li>编写服务客户端，用于生成一只新的乌龟</li>
<li>编写发布方，发布两只乌龟的坐标信息</li>
<li>编写订阅方，订阅两只乌龟信息，生成速度信息并发布</li>
<li>运行</li>
</ol>
<p><strong>准备工作:</strong></p>
<p>1.了解如何创建第二只乌龟，且不受键盘控制</p>
<p>创建第二只乌龟需要使用rosservice,话题使用的是 spawn</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rosservice call /spawn &quot;x: 1.0</span><br><span class="line">y: 1.0</span><br><span class="line">theta: 1.0</span><br><span class="line">name: &#x27;turtle_flow&#x27;&quot; </span><br><span class="line">name: &quot;turtle_flow&quot;</span><br></pre></td></tr></table></figure>

<p>键盘是无法控制第二只乌龟运动的，因为使用的话题: &#x2F;第二只乌龟名称&#x2F;cmd_vel,对应的要控制乌龟运动必须发布对应的话题消息</p>
<p>2.了解如何获取两只乌龟的坐标</p>
<p>是通过话题 &#x2F;乌龟名称&#x2F;pose 来获取的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x: 1.0 //x坐标</span><br><span class="line">y: 1.0 //y坐标</span><br><span class="line">theta: -1.21437060833 //角度</span><br><span class="line">linear_velocity: 0.0 //线速度</span><br><span class="line">angular_velocity: 1.0 //角速度</span><br></pre></td></tr></table></figure>

<hr>
<p>方案A:C++实现</p>
<h4 id="1-创建功能包-3"><a href="#1-创建功能包-3" class="headerlink" title="1.创建功能包"></a>1.创建功能包</h4><p>创建项目功能包依赖于 tf2、tf2_ros、tf2_geometry_msgs、roscpp rospy std_msgs geometry_msgs、turtlesim</p>
<h4 id="2-服务客户端-生成乌龟"><a href="#2-服务客户端-生成乌龟" class="headerlink" title="2.服务客户端(生成乌龟)"></a>2.服务客户端(生成乌龟)</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    创建第二只小乌龟</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;turtlesim/Spawn.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行初始化</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;create_turtle&quot;</span>);</span><br><span class="line">    <span class="comment">//创建节点</span></span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">//创建服务客户端</span></span><br><span class="line">    ros::ServiceClient client = nh.<span class="built_in">serviceClient</span>&lt;turtlesim::Spawn&gt;(<span class="string">&quot;/spawn&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::service::<span class="built_in">waitForService</span>(<span class="string">&quot;/spawn&quot;</span>);</span><br><span class="line">    turtlesim::Spawn spawn;</span><br><span class="line">    spawn.request.name = <span class="string">&quot;turtle2&quot;</span>;</span><br><span class="line">    spawn.request.x = <span class="number">1.0</span>;</span><br><span class="line">    spawn.request.y = <span class="number">2.0</span>;</span><br><span class="line">    spawn.request.theta = <span class="number">3.12415926</span>;</span><br><span class="line">    <span class="type">bool</span> flag = client.<span class="built_in">call</span>(spawn);</span><br><span class="line">    <span class="keyword">if</span> (flag)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">&quot;乌龟%s创建成功!&quot;</span>,spawn.response.name.<span class="built_in">c_str</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">&quot;乌龟2创建失败!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件此处略。</p>
<h4 id="3-发布方-发布两只乌龟的坐标信息"><a href="#3-发布方-发布两只乌龟的坐标信息" class="headerlink" title="3.发布方(发布两只乌龟的坐标信息)"></a>3.发布方(发布两只乌龟的坐标信息)</h4><p>可以订阅乌龟的位姿信息，然后再转换成坐标信息，两只乌龟的实现逻辑相同，只是订阅的话题名称，生成的坐标信息等稍有差异，可以将差异部分通过参数传入:</p>
<ul>
<li>该节点需要启动两次</li>
<li>每次启动时都需要传入乌龟节点名称(第一次是 turtle1 第二次是 turtle2)</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    该文件实现:需要订阅 turtle1 和 turtle2 的 pose，然后广播相对 world 的坐标系信息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    注意: 订阅的两只 turtle,除了命名空间(turtle1 和 turtle2)不同外,</span></span><br><span class="line"><span class="comment">          其他的话题名称和实现逻辑都是一样的，</span></span><br><span class="line"><span class="comment">          所以我们可以将所需的命名空间通过 args 动态传入</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    实现流程:</span></span><br><span class="line"><span class="comment">        1.包含头文件</span></span><br><span class="line"><span class="comment">        2.初始化 ros 节点</span></span><br><span class="line"><span class="comment">        3.解析传入的命名空间</span></span><br><span class="line"><span class="comment">        4.创建 ros 句柄</span></span><br><span class="line"><span class="comment">        5.创建订阅对象</span></span><br><span class="line"><span class="comment">        6.回调函数处理订阅的 pose 信息</span></span><br><span class="line"><span class="comment">            6-1.创建 TF 广播器</span></span><br><span class="line"><span class="comment">            6-2.将 pose 信息转换成 TransFormStamped</span></span><br><span class="line"><span class="comment">            6-3.发布</span></span><br><span class="line"><span class="comment">        7.spin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//1.包含头文件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;turtlesim/Pose.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/transform_broadcaster.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2/LinearMath/Quaternion.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/TransformStamped.h&quot;</span></span></span><br><span class="line"><span class="comment">//保存乌龟名称</span></span><br><span class="line">std::string turtle_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doPose</span><span class="params">(<span class="type">const</span> turtlesim::Pose::ConstPtr&amp; pose)</span></span>&#123;</span><br><span class="line">    <span class="comment">//  6-1.创建 TF 广播器 ---------------------------------------- 注意 static</span></span><br><span class="line">    <span class="type">static</span> tf2_ros::TransformBroadcaster broadcaster;</span><br><span class="line">    <span class="comment">//  6-2.将 pose 信息转换成 TransFormStamped</span></span><br><span class="line">    geometry_msgs::TransformStamped tfs;</span><br><span class="line">    tfs.header.frame_id = <span class="string">&quot;world&quot;</span>;</span><br><span class="line">    tfs.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">    tfs.child_frame_id = turtle_name;</span><br><span class="line">    tfs.transform.translation.x = pose-&gt;x;</span><br><span class="line">    tfs.transform.translation.y = pose-&gt;y;</span><br><span class="line">    tfs.transform.translation.z = <span class="number">0.0</span>;</span><br><span class="line">    tf2::Quaternion qtn;</span><br><span class="line">    qtn.<span class="built_in">setRPY</span>(<span class="number">0</span>,<span class="number">0</span>,pose-&gt;theta);</span><br><span class="line">    tfs.transform.rotation.x = qtn.<span class="built_in">getX</span>();</span><br><span class="line">    tfs.transform.rotation.y = qtn.<span class="built_in">getY</span>();</span><br><span class="line">    tfs.transform.rotation.z = qtn.<span class="built_in">getZ</span>();</span><br><span class="line">    tfs.transform.rotation.w = qtn.<span class="built_in">getW</span>();</span><br><span class="line">    <span class="comment">//  6-3.发布</span></span><br><span class="line">    broadcaster.<span class="built_in">sendTransform</span>(tfs);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="comment">// 2.初始化 ros 节点</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;pub_tf&quot;</span>);</span><br><span class="line">    <span class="comment">// 3.解析传入的命名空间</span></span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">ROS_ERROR</span>(<span class="string">&quot;请传入正确的参数&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        turtle_name = argv[<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">&quot;乌龟 %s 坐标发送启动&quot;</span>,turtle_name.<span class="built_in">c_str</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4.创建 ros 句柄</span></span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// 5.创建订阅对象</span></span><br><span class="line">    ros::Subscriber sub = nh.<span class="built_in">subscribe</span>&lt;turtlesim::Pose&gt;(turtle_name + <span class="string">&quot;/pose&quot;</span>,<span class="number">1000</span>,doPose);</span><br><span class="line">    <span class="comment">//     6.回调函数处理订阅的 pose 信息</span></span><br><span class="line">    <span class="comment">//         6-1.创建 TF 广播器</span></span><br><span class="line">    <span class="comment">//         6-2.将 pose 信息转换成 TransFormStamped</span></span><br><span class="line">    <span class="comment">//         6-3.发布</span></span><br><span class="line">    <span class="comment">// 7.spin</span></span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件此处略。</p>
<h4 id="4-订阅方-解析坐标信息并生成速度信息"><a href="#4-订阅方-解析坐标信息并生成速度信息" class="headerlink" title="4.订阅方(解析坐标信息并生成速度信息)"></a>4.订阅方(解析坐标信息并生成速度信息)</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    订阅 turtle1 和 turtle2 的 TF 广播信息，查找并转换时间最近的 TF 信息</span></span><br><span class="line"><span class="comment">    将 turtle1 转换成相对 turtle2 的坐标，在计算线速度和角速度并发布</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    实现流程:</span></span><br><span class="line"><span class="comment">        1.包含头文件</span></span><br><span class="line"><span class="comment">        2.初始化 ros 节点</span></span><br><span class="line"><span class="comment">        3.创建 ros 句柄</span></span><br><span class="line"><span class="comment">        4.创建 TF 订阅对象</span></span><br><span class="line"><span class="comment">        5.处理订阅到的 TF</span></span><br><span class="line"><span class="comment">        6.spin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//1.包含头文件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tf2_ros/transform_listener.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/TransformStamped.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/Twist.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="comment">// 2.初始化 ros 节点</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;sub_TF&quot;</span>);</span><br><span class="line">    <span class="comment">// 3.创建 ros 句柄</span></span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// 4.创建 TF 订阅对象</span></span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">listener</span><span class="params">(buffer)</span></span>;</span><br><span class="line">    <span class="comment">// 5.处理订阅到的 TF</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需要创建发布 /turtle2/cmd_vel 的 publisher 对象</span></span><br><span class="line"></span><br><span class="line">    ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;geometry_msgs::Twist&gt;(<span class="string">&quot;/turtle2/cmd_vel&quot;</span>,<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//5-1.先获取 turtle1 相对 turtle2 的坐标信息</span></span><br><span class="line">            geometry_msgs::TransformStamped tfs = buffer.<span class="built_in">lookupTransform</span>(<span class="string">&quot;turtle2&quot;</span>,<span class="string">&quot;turtle1&quot;</span>,ros::<span class="built_in">Time</span>(<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//5-2.根据坐标信息生成速度信息 -- geometry_msgs/Twist.h</span></span><br><span class="line">            geometry_msgs::Twist twist;</span><br><span class="line">            twist.linear.x = <span class="number">0.5</span> * <span class="built_in">sqrt</span>(<span class="built_in">pow</span>(tfs.transform.translation.x,<span class="number">2</span>) + <span class="built_in">pow</span>(tfs.transform.translation.y,<span class="number">2</span>));</span><br><span class="line">            twist.angular.z = <span class="number">4</span> * <span class="built_in">atan2</span>(tfs.transform.translation.y,tfs.transform.translation.x);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//5-3.发布速度信息 -- 需要提前创建 publish 对象</span></span><br><span class="line">            pub.<span class="built_in">publish</span>(twist);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// std::cerr &lt;&lt; e.what() &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;错误提示:%s&quot;</span>,e.<span class="built_in">what</span>());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        rate.<span class="built_in">sleep</span>();</span><br><span class="line">        <span class="comment">// 6.spin</span></span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件此处略。</p>
<h4 id="5-运行"><a href="#5-运行" class="headerlink" title="5.运行"></a>5.运行</h4><p>使用 launch 文件组织需要运行的节点，内容示例如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    tf2 实现小乌龟跟随案例</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 启动乌龟节点与键盘控制节点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;turtlesim&quot;</span> <span class="attr">type</span>=<span class="string">&quot;turtlesim_node&quot;</span> <span class="attr">name</span>=<span class="string">&quot;turtle1&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;turtlesim&quot;</span> <span class="attr">type</span>=<span class="string">&quot;turtle_teleop_key&quot;</span> <span class="attr">name</span>=<span class="string">&quot;key_control&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 启动创建第二只乌龟的节点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;demo_tf2_test&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Test01_Create_Turtle2&quot;</span> <span class="attr">name</span>=<span class="string">&quot;turtle2&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 启动两个坐标发布节点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;demo_tf2_test&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Test02_TF2_Caster&quot;</span> <span class="attr">name</span>=<span class="string">&quot;caster1&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span> <span class="attr">args</span>=<span class="string">&quot;turtle1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;demo_tf2_test&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Test02_TF2_Caster&quot;</span> <span class="attr">name</span>=<span class="string">&quot;caster2&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span> <span class="attr">args</span>=<span class="string">&quot;turtle2&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 启动坐标转换节点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;demo_tf2_test&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Test03_TF2_Listener&quot;</span> <span class="attr">name</span>=<span class="string">&quot;listener&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>![2024-03-03 13-39-30 的屏幕截图](C:&#x2F;Users&#x2F;zzr&#x2F;Downloads&#x2F;U5_ROS常用组件.assets&#x2F;2024-03-03 13-39-30 的屏幕截图.png)</p>
<h3 id="5-1-7-TF2与TF"><a href="#5-1-7-TF2与TF" class="headerlink" title="5.1.7 TF2与TF"></a>5.1.7 TF2与TF</h3><h4 id="1-TF2与TF比较-简介"><a href="#1-TF2与TF比较-简介" class="headerlink" title="1.TF2与TF比较_简介"></a>1.TF2与TF比较_简介</h4><ul>
<li>TF2已经替换了TF，TF2是TF的超集，建议学习 TF2 而非 TF</li>
<li>TF2 功能包的增强了内聚性，TF 与 TF2 所依赖的功能包是不同的，TF 对应的是<code>tf</code>包，TF2 对应的是<code>tf2</code>和<code>tf2_ros</code>包，在 TF2 中不同类型的 API 实现做了分包处理。</li>
<li>TF2 实现效率更高，比如在:TF2 的静态坐标实现、TF2 坐标变换监听器中的 Buffer 实现等</li>
</ul>
<h4 id="2-TF2与TF比较-静态坐标变换演示"><a href="#2-TF2与TF比较-静态坐标变换演示" class="headerlink" title="2.TF2与TF比较_静态坐标变换演示"></a>2.TF2与TF比较_静态坐标变换演示</h4><p>接下来，我们通过静态坐标变换来演示TF2的实现效率。</p>
<h5 id="2-1启动-TF2-与-TF-两个版本的静态坐标变换"><a href="#2-1启动-TF2-与-TF-两个版本的静态坐标变换" class="headerlink" title="2.1启动 TF2 与 TF 两个版本的静态坐标变换"></a>2.1启动 TF2 与 TF 两个版本的静态坐标变换</h5><p>TF2 版静态坐标变换:<code>rosrun tf2_ros static_transform_publisher 0 0 0 0 0 0 /base_link /laser</code></p>
<p>TF 版静态坐标变换:<code>rosrun tf static_transform_publisher 0 0 0 0 0 0 /base_link /laser 100</code></p>
<p>会发现，TF 版本的启动中最后多一个参数，该参数是指定发布频率</p>
<h5 id="2-2运行结果比对"><a href="#2-2运行结果比对" class="headerlink" title="2.2运行结果比对"></a>2.2运行结果比对</h5><p>使用<code>rostopic</code>查看话题，包含<code>/tf</code>与<code>/tf_static</code>, 前者是 TF 发布的话题，后者是 TF2 发布的话题，分别调用命令打印二者的话题消息</p>
<p><code>rostopic echo /tf</code>: 当前会循环输出坐标系信息</p>
<p><code>rostopic echo /tf_static</code>: 坐标系信息只有一次</p>
<h5 id="2-3结论"><a href="#2-3结论" class="headerlink" title="2.3结论"></a>2.3结论</h5><p>如果是静态坐标转换，那么不同坐标系之间的相对状态是固定的，既然是固定的，那么没有必要重复发布坐标系的转换消息，很显然的，tf2 实现较之于 tf 更为高效</p>
<h3 id="5-1-8-小结"><a href="#5-1-8-小结" class="headerlink" title="5.1.8 小结"></a>5.1.8 小结</h3><p>坐标变换在机器人系统中是一个极其重要的组成模块，在 ROS 中 TF2 组件是专门用于实现坐标变换的，TF2 实现具体内容又主要介绍了如下几部分:</p>
<p>1.静态坐标变换广播器，可以编码方式或调用内置功能包来实现(建议后者)，适用于相对固定的坐标系关系</p>
<p>2.动态坐标变换广播器，以编码的方式广播坐标系之间的相对关系，适用于易变的坐标系关系</p>
<p>3.坐标变换监听器，用于监听广播器广播的坐标系消息，可以实现不同坐标系之间或同一点在不同坐标系之间的变换</p>
<p>4.机器人系统中的坐标系关系是较为复杂的，还可以通过 tf2_tools 工具包来生成 ros 中的坐标系关系图</p>
<p>5.当前 TF2 已经替换了 TF，官网建议直接学习 TF2，并且 TF 与 TF2 的使用流程与实现 API 比较类似，只要有任意一方的使用经验，另一方也可以做到触类旁通</p>
<h2 id="5-2-rosbag"><a href="#5-2-rosbag" class="headerlink" title="5.2 rosbag"></a>5.2 rosbag</h2><p>机器人传感器获取到的信息，有时我们可能需要时时处理，有时可能只是采集数据，事后分析，比如:</p>
<blockquote>
<p>机器人导航实现中，可能需要绘制导航所需的全局地图，地图绘制实现，有两种方式，方式1：可以控制机器人运动，将机器人传感器感知到的数据时时处理，生成地图信息。方式2：同样是控制机器人运动，将机器人传感器感知到的数据留存，事后，再重新读取数据，生成地图信息。两种方式比较，显然方式2使用上更为灵活方便。</p>
</blockquote>
<p>在ROS中关于数据的留存以及读取实现，提供了专门的工具: rosbag。</p>
<hr>
<h4 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a><strong>概念</strong></h4><p>是用于录制和回放 ROS 主题的一个工具集。</p>
<h4 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a><strong>作用</strong></h4><p>实现了数据的复用，方便调试、测试。</p>
<h4 id="本质"><a href="#本质" class="headerlink" title="本质"></a><strong>本质</strong></h4><p>rosbag本质也是ros的节点，当录制时，rosbag是一个订阅节点，可以订阅话题消息并将订阅到的数据写入磁盘文件；当重放时，rosbag是一个发布节点，可以读取磁盘文件，发布文件中的话题消息。</p>
<hr>
<h3 id="5-2-1-rosbag使用-命令行"><a href="#5-2-1-rosbag使用-命令行" class="headerlink" title="5.2.1 rosbag使用_命令行"></a>5.2.1 rosbag使用_命令行</h3><p><strong>需求:</strong></p>
<p>ROS 内置的乌龟案例并操作，操作过程中使用 rosbag 录制，录制结束后，实现重放</p>
<p><strong>实现:</strong></p>
<p>1.准备</p>
<p>创建目录保存录制的文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir ./xxx</span><br><span class="line">cd xxx</span><br></pre></td></tr></table></figure>

<p>2.开始录制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosbag record -a -O 目标文件</span><br></pre></td></tr></table></figure>

<p>操作小乌龟一段时间，结束录制使用 ctrl + c，在创建的目录中会生成bag文件。</p>
<p>3.查看文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosbag info 文件名</span><br></pre></td></tr></table></figure>

<p>4.回放文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosbag play 文件名</span><br></pre></td></tr></table></figure>

<p>重启乌龟节点，会发现，乌龟按照录制时的轨迹运动。</p>
<h3 id="5-2-2-rosbag使用-编码"><a href="#5-2-2-rosbag使用-编码" class="headerlink" title="5.2.2 rosbag使用_编码"></a>5.2.2 rosbag使用_编码</h3><p>命令实现不够灵活，可以使用编码的方式，增强录制与回放的灵活性,本节将通过简单的读写实现演示rosbag的编码实现。</p>
<hr>
<p>方案A:C++实现</p>
<h4 id="1-写-bag"><a href="#1-写-bag" class="headerlink" title="1.写 bag"></a>1.写 bag</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rosbag/bag.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;std_msgs/String.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;bag_write&quot;</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">//创建bag对象</span></span><br><span class="line">    rosbag::Bag bag;</span><br><span class="line">    <span class="comment">//打开</span></span><br><span class="line">    bag.<span class="built_in">open</span>(<span class="string">&quot;/home/rosdemo/demo/test.bag&quot;</span>,rosbag::BagMode::Write);</span><br><span class="line">    <span class="comment">//写</span></span><br><span class="line">    std_msgs::String msg;</span><br><span class="line">    msg.data = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    bag.<span class="built_in">write</span>(<span class="string">&quot;/chatter&quot;</span>,ros::Time::<span class="built_in">now</span>(),msg);</span><br><span class="line">    bag.<span class="built_in">write</span>(<span class="string">&quot;/chatter&quot;</span>,ros::Time::<span class="built_in">now</span>(),msg);</span><br><span class="line">    bag.<span class="built_in">write</span>(<span class="string">&quot;/chatter&quot;</span>,ros::Time::<span class="built_in">now</span>(),msg);</span><br><span class="line">    bag.<span class="built_in">write</span>(<span class="string">&quot;/chatter&quot;</span>,ros::Time::<span class="built_in">now</span>(),msg);</span><br><span class="line">    <span class="comment">//关闭</span></span><br><span class="line">    bag.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-读bag"><a href="#2-读bag" class="headerlink" title="2.读bag"></a>2.读bag</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    读取 bag 文件：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rosbag/bag.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rosbag/view.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;std_msgs/String.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;std_msgs/Int32.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;bag_read&quot;</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建 bag 对象</span></span><br><span class="line">    rosbag::Bag bag;</span><br><span class="line">    <span class="comment">//打开 bag 文件</span></span><br><span class="line">    bag.<span class="built_in">open</span>(<span class="string">&quot;/home/rosdemo/demo/test.bag&quot;</span>,rosbag::BagMode::Read);</span><br><span class="line">    <span class="comment">//读数据</span></span><br><span class="line">    <span class="keyword">for</span> (rosbag::MessageInstance <span class="type">const</span> m : rosbag::<span class="built_in">View</span>(bag))</span><br><span class="line">    &#123;</span><br><span class="line">        std_msgs::String::ConstPtr p = m.<span class="built_in">instantiate</span>&lt;std_msgs::String&gt;();</span><br><span class="line">        <span class="keyword">if</span>(p != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">&quot;读取的数据:%s&quot;</span>,p-&gt;data.<span class="built_in">c_str</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//关闭文件流</span></span><br><span class="line">    bag.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-3-rqt工具箱"><a href="#5-3-rqt工具箱" class="headerlink" title="5.3 rqt工具箱"></a>5.3 rqt工具箱</h2><p>之前，在 ROS 中使用了一些实用的工具,比如: ros_bag 用于录制与回放、tf2_tools 可以生成 TF 树 …..  这些工具大大提高了开发的便利性，但是也存在一些问题:  这些工具的启动和使用过程中涉及到一些命令操作，应用起来不够方便，在ROS中，提供了rqt工具箱，在调用工具时以图形化操作代替了命令操作，应用更便利，提高了操作效率，优化了用户体验。</p>
<hr>
<h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a><strong>概念</strong></h4><p>ROS基于 QT 框架，针对机器人开发提供了一系列可视化的工具，这些工具的集合就是rqt</p>
<h4 id="作用-2"><a href="#作用-2" class="headerlink" title="作用"></a><strong>作用</strong></h4><p>可以方便的实现 ROS 可视化调试，并且在同一窗口中打开多个部件，提高开发效率，优化用户体验。</p>
<h4 id="组成"><a href="#组成" class="headerlink" title="组成"></a><strong>组成</strong></h4><p>rqt 工具箱组成有三大部分</p>
<ul>
<li>rqt——核心实现，开发人员无需关注</li>
<li>rqt_common_plugins——rqt 中常用的工具套件</li>
<li>rqt_robot_plugins——运行中和机器人交互的插件(比如: rviz)</li>
</ul>
<h3 id="5-3-1-rqt安装启动与基本使用"><a href="#5-3-1-rqt安装启动与基本使用" class="headerlink" title="5.3.1 rqt安装启动与基本使用"></a>5.3.1 rqt安装启动与基本使用</h3><h4 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h4><ul>
<li><p>一般只要你安装的是desktop-full版本就会自带工具箱</p>
</li>
<li><p>如果需要安装可以以如下方式安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install ros-noetic-rqt</span><br><span class="line">$ sudo apt-get install ros-noetic-rqt-common-plugins</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="2-启动"><a href="#2-启动" class="headerlink" title="2.启动"></a>2.启动</h4><p><code>rqt</code>的启动方式有两种:</p>
<ul>
<li>方式1:<code>rqt</code></li>
<li>方式2:<code>rosrun rqt_gui rqt_gui</code></li>
</ul>
<h4 id="3-基本使用"><a href="#3-基本使用" class="headerlink" title="3.基本使用"></a>3.基本使用</h4><p>启动 rqt 之后，可以通过 plugins 添加所需的插件<img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/13rqt工具箱.PNG" alt="img"></p>
<h2 id="5-3-2-rqt常用插件-rqt-graph"><a href="#5-3-2-rqt常用插件-rqt-graph" class="headerlink" title="5.3.2 rqt常用插件:rqt_graph"></a>5.3.2 rqt常用插件:rqt_graph</h2><p>**简介:**可视化显示计算图</p>
<p>**启动:**可以在 rqt 的 plugins 中添加，或者使用<code>rqt_graph</code>启动</p>
<p><img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/02_rqt_graph插件.png" alt="img"></p>
<h2 id="5-3-3-rqt常用插件-rqt-console"><a href="#5-3-3-rqt常用插件-rqt-console" class="headerlink" title="5.3.3 rqt常用插件:rqt_console"></a>5.3.3 rqt常用插件:rqt_console</h2><p>**简介:**rqt_console 是 ROS 中用于显示和过滤日志的图形化插件</p>
<p>**准备:**编写 Node 节点输出各个级别的日志信息</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    ROS 节点:输出各种级别的日志信息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;log_demo&quot;</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">0.3</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">ROS_DEBUG</span>(<span class="string">&quot;Debug message d&quot;</span>);</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">&quot;Info message oooooooooooooo&quot;</span>);</span><br><span class="line">        <span class="built_in">ROS_WARN</span>(<span class="string">&quot;Warn message wwwww&quot;</span>);</span><br><span class="line">        <span class="built_in">ROS_ERROR</span>(<span class="string">&quot;Erroe message EEEEEEEEEEEEEEEEEEEE&quot;</span>);</span><br><span class="line">        <span class="built_in">ROS_FATAL</span>(<span class="string">&quot;Fatal message FFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;</span>);</span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>启动:</strong></p>
<p>可以在 rqt 的 plugins 中添加，或者使用<code>rqt_console</code>启动<img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/01_rqt_console插件.png" alt="img"></p>
<h3 id="5-3-4-rqt常用插件-rqt-plot"><a href="#5-3-4-rqt常用插件-rqt-plot" class="headerlink" title="5.3.4 rqt常用插件:rqt_plot"></a>5.3.4 rqt常用插件:rqt_plot</h3><p>**简介:**图形绘制插件，可以以 2D 绘图的方式绘制发布在 topic 上的数据</p>
<p>**准备:**启动 turtlesim 乌龟节点与键盘控制节点，通过 rqt_plot 获取乌龟位姿</p>
<p>**启动:**可以在 rqt 的 plugins 中添加，或者使用<code>rqt_plot</code>启动<img src="C:/Users/zzr/Downloads/U5_ROS常用组件.assets/03_rqt_plot插件.png" alt="img"></p>
<h3 id="5-3-5-rqt常用插件-rqt-bag"><a href="#5-3-5-rqt常用插件-rqt-bag" class="headerlink" title="5.3.5 rqt常用插件:rqt_bag"></a>5.3.5 rqt常用插件:rqt_bag</h3><p>**简介:**录制和重放 bag 文件的图形化插件</p>
<p>**准备:**启动 turtlesim 乌龟节点与键盘控制节点</p>
<p>**启动:**可以在 rqt 的 plugins 中添加，或者使用<code>rqt_bag</code>启动</p>
<p><strong>录制:</strong></p>
<p><strong>重放:</strong></p>
<h2 id="5-4-本章小结"><a href="#5-4-本章小结" class="headerlink" title="5.4 本章小结"></a>5.4 本章小结</h2><p>本章主要介绍了ROS中的常用组件，内容如下:</p>
<ul>
<li>TF坐标变换(重点)</li>
<li>rosbag 用于ros话题的录制与回放</li>
<li>rqt工具箱，图形化方式调用组件，提高操作效率以及易用性</li>
</ul>
<p>其中 TF坐标变换是重点，也是难点，需要大家熟练掌握坐标变换的应用场景以及代码实现。下一章开始将介绍机器人系统仿真，我们将在仿真环境下，创建机器人、控制机器人运动、搭建仿真环境，并以机器人的视角去感知世界。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://inzeroworld.com.cn">Zero</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://inzeroworld.com.cn/2024/03/15/U5-ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/">http://inzeroworld.com.cn/2024/03/15/U5-ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://inzeroworld.com.cn" target="_blank">In Zero's World</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ROS/">ROS</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/05/%E6%A2%A6%E5%8D%81%E5%9B%9B%E6%94%AF%E6%95%99%E6%97%A5%E8%AE%B0-final/" title="梦十四支教日记-final"><img class="cover" src="https://s2.loli.net/2024/03/05/5rhqM4ZyCtYNfAb.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">梦十四支教日记-final</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/15/U6-%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%B3%BB%E7%BB%9F%E4%BB%BF%E7%9C%9F/" title="U6_机器人系统仿真"><img class="cover" src="https://s2.loli.net/2024/01/01/nfPDHRiY8c2vG3V.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">U6_机器人系统仿真</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/03/05/2024-03-03/" title="智能赛组会 2024-03-03"><img class="cover" src="https://s2.loli.net/2024/01/01/5aAzeSl942kDdWn.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-05</div><div class="title">智能赛组会 2024-03-03</div></div></a></div><div><a href="/2024/02/21/ROS%E8%AF%BE%E7%A8%8B%E5%A4%A7%E7%BA%B2-1/" title="ROS课程大纲"><img class="cover" src="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-21</div><div class="title">ROS课程大纲</div></div></a></div><div><a href="/2024/01/08/Aviator410/" title="Aviator410 - auto_takeoff"><img class="cover" src="https://s2.loli.net/2024/01/01/POjnvHT7tAQDb6u.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-08</div><div class="title">Aviator410 - auto_takeoff</div></div></a></div><div><a href="/2024/02/21/U1_/" title="U1_ ROS概述与环境搭建"><img class="cover" src="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-21</div><div class="title">U1_ ROS概述与环境搭建</div></div></a></div><div><a href="/2024/02/21/U2-ROS%E9%80%9A%E8%AE%AF%E6%9C%BA%E5%88%B6/" title="U2_ROS通讯机制"><img class="cover" src="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-21</div><div class="title">U2_ROS通讯机制</div></div></a></div><div><a href="/2024/02/25/U3-ROS%E9%80%9A%E8%AE%AF%E6%9C%BA%E5%88%B6%E8%BF%9B%E9%98%B6/" title="U3_ROS通讯机制进阶"><img class="cover" src="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-25</div><div class="title">U3_ROS通讯机制进阶</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2024/03/06/DdFmuoWIlGbg6fU.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zero</div><div class="author-info__description">去见证世间的美好</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KiCola"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#U5-ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">U5_ROS常用组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-TF%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">1.1.</span> <span class="toc-text">5.1 TF坐标变换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">1.1.0.3.</span> <span class="toc-text">案例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E"><span class="toc-number">1.1.0.4.</span> <span class="toc-text">说明</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-1-%E5%9D%90%E6%A0%87msg%E6%B6%88%E6%81%AF"><span class="toc-number">1.1.1.</span> <span class="toc-text">5.1.1 坐标msg消息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-geometry-msgs-TransformStamped"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">1.geometry_msgs&#x2F;TransformStamped</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-geometry-msgs-PointStamped"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">2.geometry_msgs&#x2F;PointStamped</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-2-%E9%9D%99%E6%80%81%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">1.1.2.</span> <span class="toc-text">5.1.2 静态坐标变换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%8A%9F%E8%83%BD%E5%8C%85"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">1.创建功能包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%8F%91%E5%B8%83%E6%96%B9"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">2.发布方</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%AE%A2%E9%98%85%E6%96%B9"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">3.订阅方</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">4. 配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%89%A7%E8%A1%8C"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">5.执行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-3-%E5%8A%A8%E6%80%81%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">1.1.3.</span> <span class="toc-text">5.1.3 动态坐标变换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%8A%9F%E8%83%BD%E5%8C%85-1"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">1.创建功能包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%8F%91%E5%B8%83%E6%96%B9-1"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">2.发布方</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%AE%A2%E9%98%85%E6%96%B9-1"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">3.订阅方</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%85%8D%E7%BD%AE-1"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">4.配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%89%A7%E8%A1%8C-1"><span class="toc-number">1.1.3.5.</span> <span class="toc-text">5 执行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-4-%E5%A4%9A%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">1.1.4.</span> <span class="toc-text">5.1.4 多坐标变换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%8A%9F%E8%83%BD%E5%8C%85-2"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">1.创建功能包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%8F%91%E5%B8%83%E6%96%B9-2"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">2.发布方</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%AE%A2%E9%98%85%E6%96%B9-2"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">3.订阅方</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%89%A7%E8%A1%8C"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">4.执行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-5-%E5%9D%90%E6%A0%87%E7%B3%BB%E5%85%B3%E7%B3%BB%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.1.5.</span> <span class="toc-text">5.1.5 坐标系关系查看</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1%E5%87%86%E5%A4%87"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">5.1准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E4%BD%BF%E7%94%A85"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">.2使用5</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-2-1%E7%94%9F%E6%88%90-pdf-%E6%96%87%E4%BB%B6"><span class="toc-number">1.1.5.2.1.</span> <span class="toc-text">5.2.1生成 pdf 文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-2-2%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6"><span class="toc-number">1.1.5.2.2.</span> <span class="toc-text">5.2.2查看文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-6-TF%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2%E5%AE%9E%E6%93%8D"><span class="toc-number">1.1.6.</span> <span class="toc-text">5.1.6 TF坐标变换实操</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%8A%9F%E8%83%BD%E5%8C%85-3"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">1.创建功能包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9C%8D%E5%8A%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E7%94%9F%E6%88%90%E4%B9%8C%E9%BE%9F"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">2.服务客户端(生成乌龟)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%8F%91%E5%B8%83%E6%96%B9-%E5%8F%91%E5%B8%83%E4%B8%A4%E5%8F%AA%E4%B9%8C%E9%BE%9F%E7%9A%84%E5%9D%90%E6%A0%87%E4%BF%A1%E6%81%AF"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">3.发布方(发布两只乌龟的坐标信息)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%AE%A2%E9%98%85%E6%96%B9-%E8%A7%A3%E6%9E%90%E5%9D%90%E6%A0%87%E4%BF%A1%E6%81%AF%E5%B9%B6%E7%94%9F%E6%88%90%E9%80%9F%E5%BA%A6%E4%BF%A1%E6%81%AF"><span class="toc-number">1.1.6.4.</span> <span class="toc-text">4.订阅方(解析坐标信息并生成速度信息)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%BF%90%E8%A1%8C"><span class="toc-number">1.1.6.5.</span> <span class="toc-text">5.运行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-7-TF2%E4%B8%8ETF"><span class="toc-number">1.1.7.</span> <span class="toc-text">5.1.7 TF2与TF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-TF2%E4%B8%8ETF%E6%AF%94%E8%BE%83-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">1.TF2与TF比较_简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-TF2%E4%B8%8ETF%E6%AF%94%E8%BE%83-%E9%9D%99%E6%80%81%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2%E6%BC%94%E7%A4%BA"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">2.TF2与TF比较_静态坐标变换演示</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1%E5%90%AF%E5%8A%A8-TF2-%E4%B8%8E-TF-%E4%B8%A4%E4%B8%AA%E7%89%88%E6%9C%AC%E7%9A%84%E9%9D%99%E6%80%81%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">1.1.7.2.1.</span> <span class="toc-text">2.1启动 TF2 与 TF 两个版本的静态坐标变换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%E6%AF%94%E5%AF%B9"><span class="toc-number">1.1.7.2.2.</span> <span class="toc-text">2.2运行结果比对</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3%E7%BB%93%E8%AE%BA"><span class="toc-number">1.1.7.2.3.</span> <span class="toc-text">2.3结论</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-8-%E5%B0%8F%E7%BB%93"><span class="toc-number">1.1.8.</span> <span class="toc-text">5.1.8 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-rosbag"><span class="toc-number">1.2.</span> <span class="toc-text">5.2 rosbag</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-1"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8-1"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E8%B4%A8"><span class="toc-number">1.2.0.3.</span> <span class="toc-text">本质</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-1-rosbag%E4%BD%BF%E7%94%A8-%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">1.2.1.</span> <span class="toc-text">5.2.1 rosbag使用_命令行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-rosbag%E4%BD%BF%E7%94%A8-%E7%BC%96%E7%A0%81"><span class="toc-number">1.2.2.</span> <span class="toc-text">5.2.2 rosbag使用_编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%86%99-bag"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">1.写 bag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%AF%BBbag"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.读bag</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-rqt%E5%B7%A5%E5%85%B7%E7%AE%B1"><span class="toc-number">1.3.</span> <span class="toc-text">5.3 rqt工具箱</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-2"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8-2"><span class="toc-number">1.3.0.2.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E6%88%90"><span class="toc-number">1.3.0.3.</span> <span class="toc-text">组成</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-rqt%E5%AE%89%E8%A3%85%E5%90%AF%E5%8A%A8%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">5.3.1 rqt安装启动与基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">1.安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%90%AF%E5%8A%A8"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">2.启动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">3.基本使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-2-rqt%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6-rqt-graph"><span class="toc-number">1.4.</span> <span class="toc-text">5.3.2 rqt常用插件:rqt_graph</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-3-rqt%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6-rqt-console"><span class="toc-number">1.5.</span> <span class="toc-text">5.3.3 rqt常用插件:rqt_console</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-4-rqt%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6-rqt-plot"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.3.4 rqt常用插件:rqt_plot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-5-rqt%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6-rqt-bag"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.3.5 rqt常用插件:rqt_bag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93"><span class="toc-number">1.6.</span> <span class="toc-text">5.4 本章小结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/15/U5_ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/" title="无题"><img src="https://s2.loli.net/2024/01/01/nfPDHRiY8c2vG3V.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2024/03/15/U5_ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/" title="无题">无题</a><time datetime="2024-03-14T17:33:49.800Z" title="发表于 2024-03-15 01:33:49">2024-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/15/U7-%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%AF%BC%E8%88%AA%EF%BC%88%E4%BB%BF%E7%9C%9F%EF%BC%89/" title="U7_机器人导航（仿真）"><img src="https://s2.loli.net/2024/01/01/nfPDHRiY8c2vG3V.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="U7_机器人导航（仿真）"/></a><div class="content"><a class="title" href="/2024/03/15/U7-%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%AF%BC%E8%88%AA%EF%BC%88%E4%BB%BF%E7%9C%9F%EF%BC%89/" title="U7_机器人导航（仿真）">U7_机器人导航（仿真）</a><time datetime="2024-03-14T17:29:50.000Z" title="发表于 2024-03-15 01:29:50">2024-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/15/U6-%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%B3%BB%E7%BB%9F%E4%BB%BF%E7%9C%9F/" title="U6_机器人系统仿真"><img src="https://s2.loli.net/2024/01/01/nfPDHRiY8c2vG3V.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="U6_机器人系统仿真"/></a><div class="content"><a class="title" href="/2024/03/15/U6-%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%B3%BB%E7%BB%9F%E4%BB%BF%E7%9C%9F/" title="U6_机器人系统仿真">U6_机器人系统仿真</a><time datetime="2024-03-14T17:29:29.000Z" title="发表于 2024-03-15 01:29:29">2024-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/15/U5-ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/" title="U5_ROS常用组件"><img src="https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="U5_ROS常用组件"/></a><div class="content"><a class="title" href="/2024/03/15/U5-ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/" title="U5_ROS常用组件">U5_ROS常用组件</a><time datetime="2024-03-14T17:29:12.000Z" title="发表于 2024-03-15 01:29:12">2024-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/05/%E6%A2%A6%E5%8D%81%E5%9B%9B%E6%94%AF%E6%95%99%E6%97%A5%E8%AE%B0-final/" title="梦十四支教日记-final"><img src="https://s2.loli.net/2024/03/05/5rhqM4ZyCtYNfAb.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="梦十四支教日记-final"/></a><div class="content"><a class="title" href="/2024/03/05/%E6%A2%A6%E5%8D%81%E5%9B%9B%E6%94%AF%E6%95%99%E6%97%A5%E8%AE%B0-final/" title="梦十四支教日记-final">梦十四支教日记-final</a><time datetime="2024-03-05T13:17:10.000Z" title="发表于 2024-03-05 21:17:10">2024-03-05</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2024/01/01/6KrPmZeSJzgTxFC.png')"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2024 By Zero</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">in Zero's world</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>